2026-02-07 10:29:17 | INFO     | data_processing.import_data_xlsx:import_and_process_data:48 | Detected currency for this XTB spreadsheet: PLN
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:__init__:145 | Step 1 - Initialized DataFrameProcessor with a DataFrame.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:normalize_column_names:235 | Step 2 - Normalized column names to English standard.       
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:filter_dividends:301 | Step 3 - Filtered rows to include only dividend-related data.     
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:group_by_dividends:320 | Step 4 - Grouped data by date, ticker, and type; aggregated amounts.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:create_date_d_minus_1_column:1073 | Step 4a - Created 'Date D-1' column with previous business day dates.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:calculate_dividend:873 | Step 5 - Calculated dividends and updated shares using exchange rates.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:extract_tax_percentage_from_comment:439 | Using 0% tax rate for ASB.PL (no withholding tax at source).
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:extract_tax_percentage_from_comment:450 | Extracted tax percentages from Comment column for each Date+Ticker group.
2026-02-07 10:29:17 | WARNING  | data_processing.dataframe_processor:replace_tax_with_percentage:945 | Found 1 rows with missing or zero tax percentages. Tickers: ['ASB.PL']
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:replace_tax_with_percentage:950 | Tax Collected column validated.
2026-02-07 10:29:17 | WARNING  | data_processing.dataframe_processor:replace_tax_with_percentage:958 | ⚠️  WARNING: 30% tax rate detected for US dividend(s):  MMM.US. In Poland, you can file a W8BEN form with your broker, which reduces the withholding tax from 30% to 15% according to the double taxation treaty.     
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:replace_tax_with_percentage:964 | Step 6 - Updated 'Tax Collected' column with calculated tax percentages.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:add_tax_percentage_display:1027 | Step 7 - Created 'Tax Collected %' display column with percentage formatting.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:create_date_d_minus_1_column:1073 | Step 8 - Created 'Date D-1' column with previous business day dates.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:create_exchange_rate_d_minus_1_column:1128 | Step 9 - Created 'Exchange Rate D-1' column with exchange rates for D-1 dates.
2026-02-07 10:29:17 | INFO     | data_processing.dataframe_processor:add_tax_collected_amount:1190 | Step 10 - Created 'Tax Collected Amount' column with actual tax amounts in respective currencies.
2026-02-07 10:29:17 | INFO     | data_processing.tax_calculator:calculate_tax_for_pln_statement:252 | Step 11 - Calculated tax amounts in PLN based on Polish tax rules (19% Belka tax) for PLN statement.
2026-02-07 10:29:18 | INFO     | data_processing.dataframe_processor:reorder_columns:1222 | Step 12 - Reordered columns to: Date, Ticker, Shares, Net Dividend, Tax Collected Amount, Tax Collected %, Date D-1, Exchange Rate D-1, Tax Amount PLN
2026-02-07 10:29:18 | INFO     | data_processing.dataframe_processor:log_table_with_tax_summary:1334 |
+------------+----------+--------+--------------+----------------------+-----------------+------------+-------------------+----------------+
|    Date    |  Ticker  | Shares | Net Dividend | Tax Collected Amount | Tax Collected % |  Date D-1  | Exchange Rate D-1 | Tax Amount PLN |
+------------+----------+--------+--------------+----------------------+-----------------+------------+-------------------+----------------+
| 2025-01-06 | SBUX.US  |  3.0   |   1.71 USD   |       0.30 USD       |       15%       | 2025-01-03 |    4.1512 PLN     |      0.1       |
| 2025-02-21 |  MMM.US  |  2.0   |   1.4 USD    |       0.60 USD       |       30%       | 2025-02-20 |    3.9974 PLN     |       -        |
| 2025-02-21 |  TXT.PL  |  17.0  |  28.22 PLN   |       6.62 PLN       |       19%       | 2025-02-20 |         -         |       -        |
| 2025-05-29 |  ASB.PL  |  85.0  |   25.5 USD   |          -           |        -        | 2025-05-28 |    3.7456 PLN     |     18.15      |
| 2025-05-31 | SBUX.US  |  3.0   |   1.71 USD   |       0.30 USD       |       15%       | 2025-05-30 |    3.7537 PLN     |      0.09      |
| 2025-06-25 |  XTB.PL  |  17.0  |  92.65 PLN   |      21.73 PLN       |       19%       | 2025-06-24 |         -         |       -        |
| 2025-08-19 | NOVOB.DK |  7.0   |  26.25 DKK   |       9.71 DKK       |       27%       | 2025-08-18 |    0.5702 PLN     |       -        |
| 2025-10-14 |  XTB.PL  |  7.0   |  38.15 PLN   |       8.95 PLN       |       19%       | 2025-10-13 |         -         |       -        |
+------------+----------+--------+--------------+----------------------+-----------------+------------+-------------------+----------------+
+------------------------------------------------------------------------------------------------------------------------------------------+
|                                               Total dividends received (gross): 288.61 PLN                                               |
+------------------------------------------------------------------------------------------------------------------------------------------+
|                                                     Total tax due in PLN: 18.34 PLN                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------+
|                                                   Net dividends after tax: 270.27 PLN                                                    |
+------------------------------------------------------------------------------------------------------------------------------------------+